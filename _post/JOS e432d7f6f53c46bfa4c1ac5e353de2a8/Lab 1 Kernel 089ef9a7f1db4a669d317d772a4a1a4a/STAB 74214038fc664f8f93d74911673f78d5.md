# STAB

## overview

With the -g option, GCC puts additional **debugging information** in the .s file. ( carried through into the final executable eventually)

This debugging information describes features of the source file like **line numbers, the types** and **scopes of variables,** and **functions, their parameters** and **their scopes**.

For some object file formats (natively ELF and xcoff object file), the debugging information is encapsulated in assembler directives `stab' (symbol table).

The overall format of each class of stab:

```
.stabs "string",type,0,desc,value
.stabn type,0,desc,value
.stabd type,0,desc
```

- In .stabs, the "string" field (unstructured) contains **name** and **type info**. The overall format is of the "string" field is:

```c
name[:symbol_descriptor] [type_number[=type_descriptor ...]
```

**name** is the name of the symbol represented by the stab.

The **symbol_descriptor** is an alphabetic character that tells more specifically what kind of symbol the stab represents. Here is a list of symbol_descriptors: 

```c
descriptor      meaning                                 
-------------------------------------------------
(omitted)       local variable                          
   f            local function
   F            global function
   G            global variable                         
   p            value parameter                         
   r            register variable                       
   S            static global variable    
   t            type name(typedef)                               
   T            enumeration, struct or type tag         
   V            static local variable
```

Type information is either a **type_number**, or a **`type_number='**. The **type_number** alone is a type reference, referring directly to a type that has already been defined. The **`type_number='** is a type definition, where the number represents a new type which is about to be defined.

When the **type descriptor** is non-numeric, it tells what kind of type is about to be defined. If a number follows the **`type_number='** then the number is a **type_reference**. Table below is a list of type_descriptor values. 

```c
descriptor      meaning                         
-------------------------------------
(omitted)       type reference                  
   a            array type                      
   e            enumeration type                
   f            function type                   
   r            range type                      
   s            structure type          
   u            union specifications            
   *            pointer type
```

- In .stabd, the value field is implicit (the value is **current file location**); oher class's value generally contains a **relocatable address**, **frame pointer offset**, or **register number, that maps to the source code element described by the stab**.
- type: a map between type values and stab types——
    
    ```bash
    type   type     #define   used to describe
    dec    hex      name      source program feature
    ------------------------------------------------
    32     0x20     N_GYSM    global symbol
    36     0x24     N_FUN     function name or text segment variable for C
    42     0x2a     N_MAIN    Name of main routine (not used in C)
    48     0x30     N_PC      global symbol (for Pascal)
    64     0x40     N_RSYM    register variable
    68     0x44     N_SLINE   line number in text segment
    70     0x46     N_DSLINE  line number in data segment
    72     0x48     N_BSLINE  line number in bss segment
    84     0x54     N_CATCH   GNU C++ "catch" clause
    96     0x60     N_SSYM    structure of union element
    100    0x64     N_SO      path and name of source file 
    128    0x80     N_LSYM    automatic var in the stack 
                              (also used for type desc.)
    132    0x84     N_SOL     Name of sub-source (#include) file.
    160    0xa0     N_PSYM    parameter variable
    162    0xa2     N_EINCL   end of an include file
    ```
    

## Stab type

[Encoding for the structure of the program](STAB%2074214038fc664f8f93d74911673f78d5/Encoding%20for%20the%20structure%20of%20the%20program%208dae4cfe5e4f496e90471cf14b2d75d1.md)

[Copy of Simple types——N_LSYM(128) in .stabs](STAB%2074214038fc664f8f93d74911673f78d5/Copy%20of%20Simple%20types%E2%80%94%E2%80%94N_LSYM(128)%20in%20stabs%20b4d0f2eb27dd432facc2c28618e564d9.md)

[Variables](STAB%2074214038fc664f8f93d74911673f78d5/Variables%209111cff125a748a3b0cffab43c9750a4.md)

[Aggregate Types(complex types)](STAB%2074214038fc664f8f93d74911673f78d5/Aggregate%20Types(complex%20types)%20a8eac2a16fd04ff8801caa53650633b3.md)